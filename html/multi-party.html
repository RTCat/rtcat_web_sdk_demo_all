<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>多人音视频通信</title>
    <style>
        div{
            float:left;
        }

    </style>
</head>
<body>
<div id="result" class="output"></div>
</body>
<script src="js/jquery.min.js"></script>
<script src="js/realtimecat.min.js"></script>
<script src="js/config.js"></script>
<script src="js/rtcat-utils.js"></script>

<script>
    var session,stream;

    RTCat.setRelay(true,true);
    //获取本地视频流
    RTCat.createStream({size:{width:400,height:400}}).then(function (_stream) {
        stream = _stream;
        stream.play("local");
        join();
    });

    //进入房间
    function join() {
        getSession().then(function (_session) {
            session = _session;
            session.on('in', function (token) {
                //检测到有客户端进入会话，将本地视频流发送给它
                session.sendTo({to:token,stream:stream})
            });

            session.on('remote', function (receiver) {
                receiver.on('stream',function(stream){
                    //获取远程流后，播放
                    playStream(stream,receiver.getId());
                });
                receiver.response();
            });
            session.on('error',function (error) {
                console.log(error);
            });
            session.send({stream:stream});
        }).catch(function (_error) {
            console.log(_error);
        });
    }

</script>
</html>